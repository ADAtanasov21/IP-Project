{% extends "base.html" %}

{% block content %}
<div class="catalog-header">
    <h1>–ö–∞—Ç–∞–ª–æ–≥ –æ–±—É–≤–∫–∏</h1>

    <form class="filter-form" method="GET">
        <div class="filter-row">
            <input type="text" name="search" placeholder="–¢—ä—Ä—Å–µ–Ω–µ..." value="{{ request.args.get('search', '') }}">
            <input type="text" name="color" placeholder="–¶–≤—è—Ç" value="{{ request.args.get('color', '') }}">
            <input type="number" name="min_price" placeholder="–ú–∏–Ω. —Ü–µ–Ω–∞" step="0.01" value="{{ request.args.get('min_price', '') }}">
            <input type="number" name="max_price" placeholder="–ú–∞–∫—Å. —Ü–µ–Ω–∞" step="0.01" value="{{ request.args.get('max_price', '') }}">
            <select name="size">
                <option value="">–í—Å–∏—á–∫–∏ —Ä–∞–∑–º–µ—Ä–∏</option>
                {% for size in ['37', '38', '39', '40', '41', '42', '43', '44'] %}
                    <option value="{{ size }}" {{ 'selected' if request.args.get('size') == size }}>{{ size }}</option>
                {% endfor %}
            </select>
            <select name="category">
                <option value="">–í—Å–∏—á–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                <option value="winter" {{ 'selected' if request.args.get('category') == 'winter' }}>–ó–∏–º–Ω–∏ –æ–±—É–≤–∫–∏</option>
                <option value="sport" {{ 'selected' if request.args.get('category') == 'sport' }}>–°–ø–æ—Ä—Ç–Ω–∏ –æ–±—É–≤–∫–∏</option>
                <option value="formal" {{ 'selected' if request.args.get('category') == 'formal' }}>–û—Ñ–∏—Ü–∏–∞–ª–Ω–∏ –æ–±—É–≤–∫–∏</option>
            </select>
            <button type="submit" class="btn btn-secondary">–§–∏–ª—Ç—Ä–∏—Ä–∞–π</button>
            <a href="{{ url_for('catalog.catalog') }}" class="btn btn-outline">–ò–∑—á–∏—Å—Ç–∏</a>
        </div>
    </form>
</div>

{% if winter_products %}
<div class="category-section">
    <h2>‚ùÑÔ∏è –ó–∏–º–Ω–∏ –æ–±—É–≤–∫–∏</h2>
    <div class="products-grid">
        {% for product in winter_products %}
            <div class="product-card">
                <img src="{{ product.image }}" alt="{{ product.name }}" class="product-image">
                <div class="product-info">
                    <h3>{{ product.name }}</h3>
                    <p class="product-color">–¶–≤—è—Ç: {{ product.color }}</p>
                    <p class="product-description">{{ product.description }}</p>
                    <p class="product-price">{{ "%.2f"|format(product.price) }} –ª–≤.</p>
                    <p class="product-sizes">–†–∞–∑–º–µ—Ä–∏: {{ product.sizes|join(', ') }}</p>
                    <p class="product-quantity">–ù–∞–ª–∏—á–Ω–∏: {{ product.quantity }} –±—Ä.</p>

                    {% if product.quantity > 0 %}
                        <form class="add-to-cart-form" action="{{ url_for('cart.add_to_cart', product_id=product.id) }}" method="GET">
                            <select name="size" required>
                                <option value="">–ò–∑–±–µ—Ä–µ—Ç–µ —Ä–∞–∑–º–µ—Ä</option>
                                {% for size in product.sizes %}
                                    <option value="{{ size }}">{{ size }}</option>
                                {% endfor %}
                            </select>
                            <button type="submit" class="btn btn-primary">–î–æ–±–∞–≤–∏ –≤ –∫–æ—à–Ω–∏—Ü–∞</button>
                        </form>
                    {% else %}
                        <p class="out-of-stock">–ù—è–º–∞ –≤ –Ω–∞–ª–∏—á–Ω–æ—Å—Ç</p>
                    {% endif %}
                </div>
            </div>
        {% endfor %}
    </div>
</div>
{% endif %}

{% if sport_products %}
<div class="category-section">
    <h2>‚öΩ –°–ø–æ—Ä—Ç–Ω–∏ –æ–±—É–≤–∫–∏</h2>
    <div class="products-grid">
        {% for product in sport_products %}
            <div class="product-card">
                <img src="{{ product.image }}" alt="{{ product.name }}" class="product-image">
                <div class="product-info">
                    <h3>{{ product.name }}</h3>
                    <p class="product-color">–¶–≤—è—Ç: {{ product.color }}</p>
                    <p class="product-description">{{ product.description }}</p>
                    <p class="product-price">{{ "%.2f"|format(product.price) }} –ª–≤.</p>
                    <p class="product-sizes">–†–∞–∑–º–µ—Ä–∏: {{ product.sizes|join(', ') }}</p>
                    <p class="product-quantity">–ù–∞–ª–∏—á–Ω–∏: {{ product.quantity }} –±—Ä.</p>

                    {% if product.quantity > 0 %}
                        <form class="add-to-cart-form" action="{{ url_for('cart.add_to_cart', product_id=product.id) }}" method="GET">
                            <select name="size" required>
                                <option value="">–ò–∑–±–µ—Ä–µ—Ç–µ —Ä–∞–∑–º–µ—Ä</option>
                                {% for size in product.sizes %}
                                    <option value="{{ size }}">{{ size }}</option>
                                {% endfor %}
                            </select>
                            <button type="submit" class="btn btn-primary">–î–æ–±–∞–≤–∏ –≤ –∫–æ—à–Ω–∏—Ü–∞</button>
                        </form>
                    {% else %}
                        <p class="out-of-stock">–ù—è–º–∞ –≤ –Ω–∞–ª–∏—á–Ω–æ—Å—Ç</p>
                    {% endif %}
                </div>
            </div>
        {% endfor %}
    </div>
</div>
{% endif %}

{% if formal_products %}
<div class="category-section">
    <h2>üëî –û—Ñ–∏—Ü–∏–∞–ª–Ω–∏ –æ–±—É–≤–∫–∏</h2>
    <div class="products-grid">
        {% for product in formal_products %}
            <div class="product-card">
                <img src="{{ product.image }}" alt="{{ product.name }}" class="product-image">
                <div class="product-info">
                    <h3>{{ product.name }}</h3>
                    <p class="product-color">–¶–≤—è—Ç: {{ product.color }}</p>
                    <p class="product-description">{{ product.description }}</p>
                    <p class="product-price">{{ "%.2f"|format(product.price) }} –ª–≤.</p>
                    <p class="product-sizes">–†–∞–∑–º–µ—Ä–∏: {{ product.sizes|join(', ') }}</p>
                    <p class="product-quantity">–ù–∞–ª–∏—á–Ω–∏: {{ product.quantity }} –±—Ä.</p>

                    {% if product.quantity > 0 %}
                        <form class="add-to-cart-form" action="{{ url_for('cart.add_to_cart', product_id=product.id) }}" method="GET">
                            <select name="size" required>
                                <option value="">–ò–∑–±–µ—Ä–µ—Ç–µ —Ä–∞–∑–º–µ—Ä</option>
                                {% for size in product.sizes %}
                                    <option value="{{ size }}">{{ size }}</option>
                                {% endfor %}
                            </select>
                            <button type="submit" class="btn btn-primary">–î–æ–±–∞–≤–∏ –≤ –∫–æ—à–Ω–∏—Ü–∞</button>
                        </form>
                    {% else %}
                        <p class="out-of-stock">–ù—è–º–∞ –≤ –Ω–∞–ª–∏—á–Ω–æ—Å—Ç</p>
                    {% endif %}
                </div>
            </div>
        {% endfor %}
    </div>
</div>
{% endif %}

{% if not products %}
    <p class="no-products">–ù—è–º–∞ –Ω–∞–º–µ—Ä–µ–Ω–∏ –ø—Ä–æ–¥—É–∫—Ç–∏.</p>
{% endif %}
{% endblock %}